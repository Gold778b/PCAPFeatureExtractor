# PCAP Feature Extractor - WORK IN PROGRESS
For project's progress, please see "Projects" tab in Github.
## Description
Packet model (wireshark)
Flow model (Joy, NFStream)

## Install
### Dependencies
- OS: Linux (Tested with WSL Ubuntu 18.04)
- Python 3.6.1+
- NFStream (works only on linux)
- pandas
- numpy
- scapy 2.4.4 (for parsing higher level protocols such as DNS)
- pyasn (for ASN info, requires two additional DBs)
- functools (for caching functions results)
- click (for CLI)

### Run Tests

## How To Use
Launch ```cli.py``` using Python3 with the following flags:

Flags:
- --input \<PCAP filepath\>
- --output \<output directory path\>
### Example 1
For input pcap named ```DoH-Firefox84-first-100-sec.pcap``` in subdirectory of ```pcaps```
and output extracted features to ```temp``` subdirectory, make sure that the output subdirectory exists beforehand.
```
python3 cli.py --input ./pcaps/DoH-Firefox84-first-100-sec.pcap --output ./temp
```
### Example 2

## Exported File Format
Multiple CSVs, one for each level in the hirearchy.

## Feature Hirearchy
Please see the features table.
### Timed-Windows: Features Extracted

### Uni-directional flow: Features Extracted

### Bi-directional flow (Session): Features Extracted

### Host (by source address): Features Extracted

## Directory Structure

```
└── project/       # Project's root directory.
    ├── plugins/   # NFStream plugins.
    ├── stats/     # ~ W.I.P ~
    ├── temp/      # Temporary files generated by the system.
    ├── tests/     # System tests.
    │   └── pcaps/ # PCAP files for tests.
    └── tools/     # 3rd-party tools used by the system.
```



